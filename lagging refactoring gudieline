lagging페이지 재설계 기준

현재 등록된 lagging 페이지 오류가 너무 많아서, 아래 기준으로 재설계할꺼야. 재설계시에는 배치 api를 적용해서 한번에 필요한 값들을 불러오고, 계산에 활용해. 그리고, 페이지 작성간 요구 기능이 많아서 코드가 길어질테니 개발 계획을 세울 때 코드 분할 계획도 포함해서 세워서 원할한 유지보수가 될 수 있게 해.


<표시항목>
1.사고건수 : 종합, 임직원, 협력업체
1-1. 사업장 별 사고건수

<계산 방법>
종합 : 해당년도의 모든 사고 건수, 임직원, 협력업체 포함 
임직원 : 해당년도의 임직원 사고건수
협력업체 : 해당년도의 협력업체 사고건수, 협력업체 여부는 보고서의 협력업체 사고 여부 체크에 따라 구분
해당년도 판단기준 :  사고코드의 년도에서 산출, 주의할점, 보고서 생성시점이 아님. 24년도 사고임에도 25년도 등록될 수 있음. 
사업장별 사고건수 : 해당년도 해당사업장의 모든 사고건수
해당사업장 판단기준 : 사고코드의 사업장 코드로 판단.
사고코드의 형식 : HHH-AA-2025-001 [회사코드]-[사업장코드]-[년도]-[순번]


<표시항목>
2.재해자수 : 종합, 임직원, 협력업체
2-1.상해유형별 재해자수 : 사망, 중상, 경상, 병원치료, 응급처치, 기타

<계산방법>
종합 : 해당년도의 모든 재해자수, 임직원 ,협력업체 포함.
임직원 : 해당년도의 임직원 재해자 수
협력업체 : 해당년도의 협력업체 재해자 수, 재해자 정보의 협력업체 재해자 여부 체크에 따라 구분
상해유형
상해유형 : 재해자 정보의 상해유형에 따라 구분
재해자정보는 별도의 재해자 테이블에서 관리


<표시항목>
3.물적피해 : 종합
3-1 : 간접피해금액 
<계산방법>
종합 : 해당년도 모든 물적, 복합 사고의 피해금액의 합계(직접피해금액)
간접피해금액 : 해당년도 직접피해금액 * 4


<표시항목>
4.LTIR : 종합
4-1 : 임직원 LTIR, 협력업체 LTIR

<계산방법>
종합 : LTIR 대상 사고 건수의 합 / 연간 총근로시간 * 상수
임직원 LTIR : LTIR 대상 임직원 사고 건수의 합 / 연간 임직원 총근로시간 * 상수
협력업체 LTIR : LTIR 대상 협력업체 사고 건수의 합 / 연간 협력업체 총근로시간 * 상수
LTIR 대상 사고 : 사망, 중상, 경상, 기타 재해자가 발생한 사고 건
연간 총근로시간 : 해당 년도의 년간 총근로시간 값(별도 테이블에 년도별 저장)
임직원 총근로시간 : 해당 년도의 년간 임직원 총 근로시간 값(별도 테이블에 년도별 저장)
협력업체 총근로시간 : 해당년도의 년간 협력업체 총근로시간 값(별도 테이블에 년도별 저장, 상주 + 비상주)  
상수 : 200000, 1000000 두 개 값 중 20만시가 메인, 100만시는 토글되었을 때 표시


<표시항목>
5.TRIR : 종합
5-1 : 임직원 TRIR, 협력업체 TRIR

<계산방법>
종합 : TRIR 대상 사고 건수의 합 / 연간 총근로시간 * 상수
임직원 TRIR : TRIR 대상 임직원 사고 건수의 합 / 연간 임직원 총근로시간 * 상수
협력업체 TRIR : TRIR 대상 협력업체 사고 건수의 합 / 연간 협력업체 총근로시간 * 상수
TRIR 대상 사고 : 사망, 중상, 경상, 기타, 병원치료 재해자가 발생한 사고 건
연간 총근로시간 : 해당 년도의 년간 총근로시간 값(별도 테이블에 년도별 저장)
임직원 총근로시간 : 해당 년도의 년간 임직원 총 근로시간 값(별도 테이블에 년도별 저장)
협력업체 총근로시간 : 해당년도의 년간 협력업체 총근로시간 값(별도 테이블에 년도별 저장, 상주 + 비상주)
상수 : 200000, 1000000 두 개 값 중 20만시가 메인, 100만시는 토글되었을 때 표시


<표시항목>
6.강도율 : 종합
6-1: 임직원 강도율, 협력업체 강도율
<계산방법>
강도율 종합 : 년간 총 재해자 근로손실일수 / 년간 총 근로시간 * 1000
임직원 강도율 : 년간 총 임직원 재해자 근로손실일수 / 년간 총 임직원 근로시간 * 1000
협력업체 강도율 : 년간 총 협력업체 재해자 근로손실일수 / 년간 총 협력업체 근로시간 * 1000
근로손실일수 산정 방법
사망 : 7500일
사망 외 : 실제 근로손실일
실제근로손실일 산정 방법 : 조사보고서 재해자 정보의 복귀(예정)일 - 휴업시작일 로 계산
조사보고서에 재해자 정보에 복귀 예정일, 휴업시작일 정보가 미입력되어 있는경우 또는 발생보고서만 있는 경우 
복귀 예정일은 현재일, 휴업시작일은 사고발생일 로 대체하여 계산
현재일 값은 /setting 헤이지의 현재시간 함수에서 호출

<화면설계> 모바일 반응형

[사고지표 카드]
재해건수, 재해자수, 물적피해금액
LTIR, TRIR, 강도율


사고지표 카드 는 조회년도의 선택에 따라 해당년도의 지표값을 보여줌. 년도는 최신년도 를 상단에 표시하는 졍렬기준의 드롭다운으로 설겨

년도 값은 사고보고서가 등록되어 있는 최초 년도부터 현재까지의 모든 년도를 선택가능해야함

[사고지표 동향]
차트 유형 : 기본차트, 상세차트 - 버튼 방식으로 스위치
차트표시 : 오른쪽이 최신년도가 오도록 정렬, 하단부에는 지표에 관한 간단한 설명, 그래프 값 표시

기본차트는 최근 5개년 표시가 기본설정 값, 사용자 선택에 따라 전체 년도 조정 가능해야함 
기본차트1(화면 왼쪽)
재해건수(왼쪽축), 재해자수(왼쪽축), 물적피해(오른쪽축, 막대그래프) 의 종합값 표시,
기본차트2(화면 오른쪽)
LTIR(왼쪽축), TRIR(왼쪽축), 강도율(오른쪽축, 막대그래프) 의 종합값 표시


상세차트 
상세차트는 최근 10개년 표시가 기본설정 값, 사용자 선택에 따라 전체 년도 조정가능해야 함.
상세차트 1
재해건수, 재해자수, 전체 대비 사업장별 값 표현 예) 전체가 10이고, A사업장이 7, B사업장이 3이면, 막대그래프를 7+3으로 10을 만듬 막대그래프 내에서는 색상으로 사업장 구분
상세차트2
LTIR, TRIR, 종합, 임직원, 협력업체 추이 모두 표시
상세차트 3
강도율, 종합, 임직원, 협력업체 추이 모두 표시
